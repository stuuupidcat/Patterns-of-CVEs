rules:
  - id: CVE-2019-15548_1
    languages: [rust]
    patterns:
      - pattern-either:
        - pattern: $MOD::instr(...)
        - pattern: instr(...)
      - pattern-inside: |
          pub fn $FUNC(...) {
            ...
          }
      - pattern-not-inside: |
          pub unsafe fn $FUNC(...) {
            ...
          }
    message: |
      Check the function `$FUNC` which calls the `instr` method and is marked as `safe`. 
      Mark the function as `unsafe` to prevent potential memory safety issues.
    severity: ERROR
  - id: CVE-2019-15548_2
    languages: [rust]
    patterns:
      - pattern-either:
        - pattern: $MOD::mvwinstr(...)
        - pattern: mvwinstr(...)
      - pattern-inside: |
          pub fn $FUNC(...) {
            ...
          }
      - pattern-not-inside: |
          pub unsafe fn $FUNC(...) {
            ...
          }
    message: |
      Check the function `$FUNC` which calls the `mvwinstr` method and is marked as `safe`. 
      Mark the function as `unsafe` to prevent potential memory safety issues.
    severity: ERROR
    