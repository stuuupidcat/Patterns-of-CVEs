rules:
  - id: CVE-2020-35861
    languages: [rust]
    patterns:
      - metavariable-regex:
          metavariable: $NEW_LEN
          regex: new_.*
      - pattern-either:
          - pattern: std::ptr::copy($FROM, $TO, $NEW_LEN);
          - pattern: ptr::copy($FROM, $TO, $NEW_LEN);
          - pattern: copy($FROM, $TO, $NEW_LEN);
    message: |
      It seems that you pass the wrong length `$NEW_LEN`, which is supposed to be the length corresponding to `$FROM` but not `$TO`, to `ptr::copy`.
    severity: WARNING
